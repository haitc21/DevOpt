# Override Files

## 1. Override Files là gì?

- Terraform bình thường không cho phép định nghĩa trùng object trong các file .tf.
- Tuy nhiên, trong trường hợp đặc biệt, có thể dùng override file để ghi đè (override) một phần cấu hình có sẵn.
- Các file override có tên:
  - override.tf hoặc override.tf.json
  - Hoặc kết thúc bằng _override.tf /_override.tf.json.

## 2. Cách hoạt động

- Terraform bỏ qua override files khi load ban đầu, sau đó xử lý chúng theo thứ tự từ điển (lexicographical order).
- Mỗi block trong override file merge vào block tương ứng trong cấu hình gốc.
- Nếu nhiều override file cùng ghi đè, file sau sẽ có ưu tiên cao hơn.

## 3. Quy tắc merge chung

- Block cùng header → merge.
- Thuộc tính (attribute) trùng tên → bị ghi đè.
 -Block lồng nhau cùng loại → bị thay thế toàn bộ, không merge sâu.
- Kết quả merge phải hợp lệ theo quy tắc Terraform.

## 4. Ví dụ

- main.tf

```hcl
resource "aws_instance" "web" {
  instance_type = "t2.micro"
  ami           = "ami-408c7f28"
}
```

- override.tf

``` hcl
resource "aws_instance" "web" {
  ami = "foo"
}
```

- Kết quả

```hcl
resource "aws_instance" "web" {
  instance_type = "t2.micro"
  ami           = "foo"
}
```
